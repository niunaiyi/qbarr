# *arr å®¹å™¨æ§åˆ¶å™¨

ğŸ³ æ ¹æ®qbittorrenå·²ä¸‹è½½æ–‡ä»¶å¤§å°,æ§åˆ¶ *arrå¯åŠ¨æˆ–åœæ­¢,ä»è€Œå‡å°‘ç£ç›˜æ´»åŠ¨,è¾¾åˆ°ä¿æŠ¤ç£ç›˜çš„ç›®çš„.

å½“qbittorrentä¸‹è½½å®Œæˆçš„æ–‡ä»¶å¤§å°è¶…è¿‡æŒ‡å®šå¤§å°,åˆšå¯åŠ¨*arr,æŠŠæ–‡ä»¶ä»qbittorrentç§»åŠ¨åˆ°æŒ‡å®šçš„ç›®å½•.

å½“qbittorrentä¸‹è½½å®Œæˆçš„æ–‡ä»¶å¤§å°ä½äºæŒ‡å®šå¤§å°,åˆšåœæ­¢*arr,è®©qbittorrentç»§ç»­ä¸‹è½½.

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- ğŸ¯ **Web ç•Œé¢ç®¡ç†** - é€šè¿‡ç°ä»£åŒ–çš„ Web ç•Œé¢ç›´è§‚åœ°ç®¡ç† Docker å®¹å™¨
- ğŸš€ **å®¹å™¨æ§åˆ¶** - å¯åŠ¨ã€åœæ­¢ã€é‡å¯ã€æš‚åœã€æ¢å¤å®¹å™¨
- ğŸ“Š **å®æ—¶ç»Ÿè®¡** - æŸ¥çœ‹å®¹å™¨å’Œé•œåƒçš„å®æ—¶ç»Ÿè®¡ä¿¡æ¯
- ğŸ”„ **è‡ªåŠ¨åˆ·æ–°** - æ¯ 30 ç§’è‡ªåŠ¨åˆ·æ–°å®¹å™¨çŠ¶æ€
- ğŸ¨ **ç¾è§‚ç•Œé¢** - å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒç§»åŠ¨ç«¯è®¿é—®
- âš¡ **å¿«é€Ÿå“åº”** - åŸºäº NestJS æ¡†æ¶ï¼Œæ€§èƒ½ä¼˜å¼‚
- ğŸ” **é€‰æ‹©æ€§ç›‘æ§** - å¯é…ç½®åªç›‘æ§æŒ‡å®šçš„å®¹å™¨ï¼ˆé»˜è®¤ç›‘æ§æ‰€æœ‰ *arr ç³»åˆ—å®¹å™¨ï¼‰
- ğŸ“Š **è‡ªåŠ¨å¯åœ** - æ ¹æ®æ–‡ä»¶å¤¹å¤§å°è‡ªåŠ¨å¯åœå®¹å™¨ï¼ˆå¯é€‰åŠŸèƒ½ï¼‰

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **åç«¯æ¡†æ¶**: NestJS (TypeScript)
- **Docker SDK**: dockerode
- **å‰ç«¯**: åŸç”Ÿ HTML/CSS/JavaScript
- **å®¹å™¨åŒ–**: Docker & Docker Compose

## ğŸ“‹ å‰ç½®è¦æ±‚

- Docker 20.10+
- Docker Compose 2.0+

## ğŸš€ å¿«é€Ÿå¼€å§‹

> ğŸ’¡ **æ¨èéƒ¨ç½²æ–¹å¼**:
> - ğŸ¯ **æœ€ç®€å•**: [é•œåƒæ–¹å¼éƒ¨ç½²](QUICK-DEPLOY.md) - æ— éœ€æºä»£ç ï¼Œç›´æ¥è¿è¡Œ
> - ğŸªŸ **Windows ç”¨æˆ·**: [Windows æ„å»ºæŒ‡å—](WINDOWS-BUILD.md) - Windows ä¸“ç”¨æ•™ç¨‹
> - ğŸ“š **å®Œæ•´æŒ‡å—**: [Linux éƒ¨ç½²æŒ‡å—](DEPLOY.md) - è¯¦ç»†çš„éƒ¨ç½²æ–‡æ¡£

### ä½¿ç”¨ Docker Composeï¼ˆæ¨èï¼‰

1. **å…‹éš†é¡¹ç›®**
```bash
cd rswd
```

2. **å¯åŠ¨æœåŠ¡**
```bash
docker-compose up -d
```

3. **è®¿é—® Web ç•Œé¢**
```
æ‰“å¼€æµè§ˆå™¨è®¿é—®: http://localhost:8011
```

4. **æŸ¥çœ‹æ—¥å¿—**
```bash
docker-compose logs -f
```

5. **åœæ­¢æœåŠ¡**
```bash
docker-compose down
```

### ä½¿ç”¨ Docker å‘½ä»¤

1. **æ„å»ºé•œåƒ**
```bash
docker build -t qbarr .
```

2. **è¿è¡Œå®¹å™¨**
```bash
docker run -d \
  --name qbarr \
  -p 8011:8011 \
  -e PORT=8011 \
  -v /var/run/docker.sock:/var/run/docker.sock \
  qbarr
```

3. **è®¿é—®åº”ç”¨**
```
http://localhost:8011
```

## ğŸ”§ æœ¬åœ°å¼€å‘

### å®‰è£…ä¾èµ–

```bash
npm install
```

### å¼€å‘æ¨¡å¼è¿è¡Œ

```bash
npm run start:dev
```

### æ„å»ºç”Ÿäº§ç‰ˆæœ¬

```bash
npm run build
npm run start:prod
```

## ğŸ“¡ API ç«¯ç‚¹

### å®¹å™¨ç®¡ç†

- `GET /api/docker/containers` - åˆ—å‡ºæ‰€æœ‰å®¹å™¨ï¼ˆæ”¯æŒæŸ¥è¯¢å‚æ•° `?all=true`ï¼‰
- `POST /api/docker/containers/:id/start` - å¯åŠ¨å®¹å™¨
- `POST /api/docker/containers/:id/stop` - åœæ­¢å®¹å™¨

## ğŸ¯ ä½¿ç”¨ç¤ºä¾‹

### å¯åŠ¨å®¹å™¨

```bash
curl -X POST http://localhost:8011/api/docker/containers/{container_id}/start
```

### åœæ­¢å®¹å™¨

```bash
curl -X POST http://localhost:8011/api/docker/containers/{container_id}/stop \
  -H "Content-Type: application/json" \
  -d '{"timeout": 10}'
```

### åˆ—å‡ºæ‰€æœ‰å®¹å™¨

```bash
curl http://localhost:8011/api/docker/containers?all=true
```

## âš™ï¸ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡

- `PORT` - åº”ç”¨ç«¯å£ï¼ˆé»˜è®¤: 8011ï¼‰
- `NODE_ENV` - è¿è¡Œç¯å¢ƒï¼ˆdevelopment/productionï¼‰
- `MONITORED_CONTAINERS` - è¦ç›‘æ§çš„å®¹å™¨åç§°åˆ—è¡¨ï¼ˆé»˜è®¤: arrï¼Œç›‘æ§æ‰€æœ‰ *arr ç³»åˆ—å®¹å™¨ï¼‰
- `MONITOR_PATH` - ç›‘æ§çš„æ–‡ä»¶å¤¹è·¯å¾„ï¼ˆå®¹å™¨å†…è·¯å¾„ï¼‰
- `EXCLUDE_FOLDER` - æ’é™¤è®¡ç®—çš„æ–‡ä»¶å¤¹åç§°ï¼ˆé»˜è®¤: incompleteï¼‰
- `START_THRESHOLD_GB` - å¯åŠ¨å®¹å™¨çš„æ–‡ä»¶å¤¹å¤§å°é˜ˆå€¼ï¼ˆGBï¼‰
- `STOP_THRESHOLD_GB` - åœæ­¢å®¹å™¨çš„æ–‡ä»¶å¤¹å¤§å°é˜ˆå€¼ï¼ˆGBï¼‰

### è‡ªå®šä¹‰ç›‘æ§å®¹å™¨

ç¼–è¾‘ `docker-compose.yml` ä¸­çš„ç¯å¢ƒå˜é‡ï¼š

```yaml
environment:
  # ç›‘æ§æ‰€æœ‰ *arr ç³»åˆ—å®¹å™¨ï¼ˆé»˜è®¤ï¼‰
  - MONITORED_CONTAINERS=arr
  
  # æˆ–æŒ‡å®šå…·ä½“çš„å®¹å™¨
  # - MONITORED_CONTAINERS=radarr,sonarr,lidarr,prowlarr
```

æˆ–ä½¿ç”¨ Docker å‘½ä»¤ï¼š

```bash
# ç›‘æ§æ‰€æœ‰ *arr ç³»åˆ—å®¹å™¨
docker run -d \
  -e MONITORED_CONTAINERS=arr \
  ...

# æˆ–æŒ‡å®šå…·ä½“å®¹å™¨
docker run -d \
  -e MONITORED_CONTAINERS=radarr,sonarr,lidarr \
  ...
```

**è¯´æ˜**:
- é»˜è®¤é…ç½® `arr` ä¼šç›‘æ§æ‰€æœ‰ *arr ç³»åˆ—å®¹å™¨ï¼ˆradarr, sonarr, lidarr, readarr, prowlarr, whisparr ç­‰ï¼‰
- æ”¯æŒé€—å·åˆ†éš”å¤šä¸ªå®¹å™¨å
- ä¸åŒºåˆ†å¤§å°å†™
- æ”¯æŒéƒ¨åˆ†åŒ¹é…ï¼ˆå¦‚ "radarr" ä¼šåŒ¹é… "radarr-1", "my-radarr" ç­‰ï¼‰
- è¯¦ç»†é…ç½®è¯·æŸ¥çœ‹: [CONFIG.md](CONFIG.md)

### æ–‡ä»¶å¤¹ç›‘æ§ä¸è‡ªåŠ¨å¯åœ

ç³»ç»Ÿå¯ä»¥ç›‘æ§æŒ‡å®šç›®å½•çš„å¤§å°ï¼Œå¹¶æ ¹æ®é˜ˆå€¼è‡ªåŠ¨å¯åœå®¹å™¨ï¼š

```yaml
environment:
  - MONITOR_ENABLED=true              # å¯ç”¨ç›‘æ§
  - MONITOR_PATH=/downloads           # ç›‘æ§è·¯å¾„
  - EXCLUDE_FOLDER=incomplete         # æ’é™¤çš„æ–‡ä»¶å¤¹
  - START_THRESHOLD_GB=100            # å¯åŠ¨é˜ˆå€¼ï¼ˆGBï¼‰
  - STOP_THRESHOLD_GB=50              # åœæ­¢é˜ˆå€¼ï¼ˆGBï¼‰
```

**å·¥ä½œåŸç†**:
- å½“æ–‡ä»¶å¤¹å¤§å° â‰¥ 100GB â†’ è‡ªåŠ¨å¯åŠ¨æ‰€æœ‰ *arr å®¹å™¨
- å½“æ–‡ä»¶å¤¹å¤§å° â‰¤ 50GB â†’ è‡ªåŠ¨åœæ­¢æ‰€æœ‰ *arr å®¹å™¨
- æ–‡ä»¶å¤¹å¤§å°åœ¨ 50-100GB ä¹‹é—´ â†’ ä¿æŒå½“å‰çŠ¶æ€

**è¯¦ç»†è¯´æ˜**: [MONITOR.md](MONITOR.md)

### Docker Socket

åº”ç”¨é€šè¿‡æŒ‚è½½ Docker socket æ¥æ§åˆ¶å®¿ä¸»æœºçš„ Dockerï¼š

```yaml
volumes:
  - /var/run/docker.sock:/var/run/docker.sock
```

**âš ï¸ å®‰å…¨æç¤º**: æŒ‚è½½ Docker socket ä¼šç»™äºˆå®¹å™¨å®Œå…¨çš„ Docker æ§åˆ¶æƒé™ï¼Œè¯·ä»…åœ¨å—ä¿¡ä»»çš„ç¯å¢ƒä¸­ä½¿ç”¨ã€‚

## ğŸ”’ å®‰å…¨å»ºè®®

1. **ç½‘ç»œéš”ç¦»** - åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨åå‘ä»£ç†ï¼ˆå¦‚ Nginxï¼‰
2. **è®¿é—®æ§åˆ¶** - æ·»åŠ èº«ä»½éªŒè¯æœºåˆ¶
3. **HTTPS** - å¯ç”¨ HTTPS åŠ å¯†é€šä¿¡
4. **é˜²ç«å¢™** - é™åˆ¶ç«¯å£è®¿é—®èŒƒå›´
5. **æœ€å°æƒé™** - åªæŒ‚è½½å¿…è¦çš„ Docker socket

## ğŸ“¸ ç•Œé¢é¢„è§ˆ

Web ç•Œé¢æä¾›ä»¥ä¸‹åŠŸèƒ½ï¼š

- ğŸ“Š å®æ—¶æ˜¾ç¤ºå®¹å™¨ç»Ÿè®¡ä¿¡æ¯ï¼ˆæ€»æ•°ã€è¿è¡Œä¸­ã€æš‚åœã€åœæ­¢ï¼‰
- ğŸ“¦ å®¹å™¨åˆ—è¡¨å±•ç¤ºï¼ŒåŒ…å«åç§°ã€IDã€é•œåƒã€çŠ¶æ€
- ğŸ® ä¸€é”®æ“ä½œæŒ‰é’®ï¼ˆå¯åŠ¨ã€åœæ­¢ã€é‡å¯ã€æš‚åœã€åˆ é™¤ï¼‰
- ğŸ”„ è‡ªåŠ¨åˆ·æ–°å’Œæ‰‹åŠ¨åˆ·æ–°åŠŸèƒ½
- ğŸ“± å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒæ‰‹æœºå’Œå¹³æ¿è®¿é—®

## ğŸ› æ•…éšœæ’é™¤

### æ— æ³•è¿æ¥åˆ° Docker

**é—®é¢˜**: åº”ç”¨æ— æ³•è¿æ¥åˆ° Docker å®ˆæŠ¤è¿›ç¨‹

**è§£å†³æ–¹æ¡ˆ**:
1. ç¡®è®¤ Docker æœåŠ¡æ­£åœ¨è¿è¡Œ
2. æ£€æŸ¥ Docker socket è·¯å¾„æ˜¯å¦æ­£ç¡®æŒ‚è½½
3. æŸ¥çœ‹å®¹å™¨æ—¥å¿—: `docker-compose logs qbarr`

### æƒé™é—®é¢˜

**é—®é¢˜**: æƒé™è¢«æ‹’ç»

**è§£å†³æ–¹æ¡ˆ**:
```bash
# ç¡®ä¿ Docker socket æœ‰æ­£ç¡®çš„æƒé™
sudo chmod 666 /var/run/docker.sock
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
.
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.ts                 # åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ app.module.ts           # ä¸»æ¨¡å—
â”‚   â””â”€â”€ docker/
â”‚       â”œâ”€â”€ docker.module.ts    # Docker æ¨¡å—
â”‚       â”œâ”€â”€ docker.controller.ts # Docker æ§åˆ¶å™¨
â”‚       â””â”€â”€ docker.service.ts   # Docker æœåŠ¡
â”œâ”€â”€ public/
â”‚   â””â”€â”€ index.html              # Web ç•Œé¢
â”œâ”€â”€ Dockerfile                  # Docker é•œåƒå®šä¹‰
â”œâ”€â”€ docker-compose.yml          # Docker Compose é…ç½®
â”œâ”€â”€ package.json                # é¡¹ç›®ä¾èµ–
â”œâ”€â”€ tsconfig.json              # TypeScript é…ç½®
â””â”€â”€ README.md                  # é¡¹ç›®æ–‡æ¡£
```

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ”— ç›¸å…³é“¾æ¥

- [NestJS æ–‡æ¡£](https://docs.nestjs.com/)
- [dockerode æ–‡æ¡£](https://github.com/apocas/dockerode)
- [Docker API æ–‡æ¡£](https://docs.docker.com/engine/api/)

## ğŸ’¡ æç¤º

- é»˜è®¤æ¯ 30 ç§’è‡ªåŠ¨åˆ·æ–°å®¹å™¨çŠ¶æ€
- åˆ é™¤å®¹å™¨å‰ä¼šæœ‰ç¡®è®¤æç¤º
- æ”¯æŒæŸ¥çœ‹æ‰€æœ‰å®¹å™¨ï¼ˆåŒ…æ‹¬å·²åœæ­¢çš„ï¼‰
- å®¹å™¨æŒ‰çŠ¶æ€æ˜¾ç¤ºä¸åŒé¢œè‰²æ ‡è¯†

---

**æ³¨æ„**: æ­¤å·¥å…·æä¾›äº†å¯¹å®¿ä¸»æœº Docker çš„å®Œå…¨æ§åˆ¶æƒé™ï¼Œè¯·åœ¨å®‰å…¨çš„ç¯å¢ƒä¸­ä½¿ç”¨ï¼Œå¹¶åšå¥½è®¿é—®æ§åˆ¶ã€‚



